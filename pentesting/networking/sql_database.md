#  SQL Databases
## Enumeration
 * [MXToolbox](https://mxtoolbox.com/)
 * [smtp-user-enum](https://github.com/pentestmonkey/smtp-user-enum)

```
nmap -Pn -sV -sC -p1433 $rhost
nmap -Pn -sV -sC -p1433 10.10.10.125 # Example
```
## Authentication Mechanisms

### MSSQL

MSSQL supports two [authentication modes](https://learn.microsoft.com/en-us/sql/connect/ado-net/sql/authentication-sql-server?view=sql-server-ver16), which means that users can be created in Windows or the SQL Server:
1. **Windows authentication mode:** This is the default, often referred to as integrated security because the SQL Server security model is tightly integrated with Windows/Active Directory. Specific Windows user and group accounts are trusted to log in to SQL Server. Windows users who have already been authenticated do not have to present additional credentials. 
2. **Mixed mode**: Mixed mode supports authentication by Windows/Active Directory accounts and SQL Server. Username and password pairs are maintained within SQL Server.

### MySQL
MySQL also supports different authentication methods, such as username and password, as well as Windows authentication (a plugin is required). In addition, administrators can choose an authentication mode for many reasons, including compatibility, security, usability, and more. However, depending on which method is implemented, misconfigurations can occur.

### MySQL - Connecting to the SQL Server

```
mysql -u $username -p$password -h $rhost
mysql -u julio -pPassword123 -h 10.129.20.13 # Example
```

### Sqlcmd - Connecting to the SQL Server

```
sqlcmd -S SRVMSSQL -U $username -P '$password' -y 30 -Y 30
sqlcmd -S SRVMSSQL -U julio -P 'MyPassword!' -y 30 -Y 30 # Example

Note: When we authenticate to MSSQL using sqlcmd we can use the parameters -y (SQLCMDMAXVARTYPEWIDTH) and -Y (SQLCMDMAXFIXEDTYPEWIDTH) for better looking output. Keep in mind it may affect performance.
```
Alternatively, we can use the tool from Impacket with the name mssqlclient.py
```
mssqlclient.py -p $port $user@$rhost
mssqlclient.py -p 1433 julio@10.129.203.7 # Example

Note: When we authenticate to MSSQL using sqsh we can use the parameters -h to disable headers and footers for a cleaner look.
```
When using Windows Authentication, we need to specify the domain name or the hostname of the target machine. If we don't specify a domain or hostname, it will assume SQL Authentication and authenticate against the users created in the SQL Server. Instead, if we define the domain or hostname, it will use Windows Authentication. If we are targetting a local account, we can use SERVERNAME\\accountname or. The full command would look like:
```
sqsh -S $rhost -U .\\$username -P '$password' -h
sqsh -S 10.129.203.7 -U .\\julio -P 'MyPassword!' -h # Example
```

## SQL Default Databases



